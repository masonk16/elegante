{% extends "base.html" %}
{% load i18n %}
{% load widget_tweaks %}

{% block title %}
{%  trans 'Checkout' %}
{% endblock %}

{% block content %}

    <!-- breadcrumbs -->
    <section class="breadcrumbs separator-bottom">
        <div class="container">
            <div class="row">
                <div class="col">
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="{% url 'shop:home' %}">{%  trans 'Home' %}</a></li>
                            <li class="breadcrumb-item"><a href="{% url 'shop:product_list' %}">{%  trans 'Shop' %}</a></li>
                            <li class="breadcrumb-item active" aria-current="page">{%  trans 'Checkout' %}</li>
                        </ol>
                    </nav>
                </div>
            </div>
        </div>
    </section>

    <!-- hero -->
    <section>
        <div class="container">
            <div class="row">
                <div class="col text-center">
                    <h1>{%  trans 'Checkout' %}</h1>
                </div>
            </div>
        </div>
    </section>

    <section class="no-overflow pt-0">
        <div class="container">
            <div class="row gutter-4 justify-content-between">


                <div class="col-lg-8">

                <!-- delivery -->
                    <div class="row align-items-end mb-2">
                        <div class="col-md-6">
                            <h2 class="h3 mb-0"><span class="text-muted">01.</span> Billing Details</h2>
                        </div>
                    </div>
                    <form action="#" method="post" class="row gutter-1 mb-6">
                        {% csrf_token %}
                        <div class="form-group col-md-6">
                            <label>First Name</label>
                            {{ form.first_name|add_class:"form-control" }}
                        </div>
                        <div class="form-group col-md-6">
                            <label>Last Name</label>
                            {{ form.last_name|add_class:"form-control" }}
                        </div>
                        <div class="form-group col-md-6">
                            <label>Email</label>
                            {{ form.email|add_class:"form-control" }}
                        </div>
                        <div class="form-group col-md-6">
                            <label>Phone Number</label>
                            {{ form.phone_number|add_class:"form-control" }}
                        </div>
                        <div class="form-group col-md-12">
                            <label>Address</label>
                            {{ form.address|add_class:"form-control" }}
                        </div>
                        <div class="form-group col-md-4">
                            <label>Postal Code</label>
                            {{ form.postal_code|add_class:"form-control" }}
                        </div>
                        <div class="form-group col-md-8">
                            <label>City</label>
                            {{ form.city|add_class:"form-control" }}
                        </div>
                        <!-- place order -->
                        <div class="col-12 mt-1">
                            <button type="submit" class="btn btn-primary btn-lg btn-block">
                                {% trans "Place order" %}
                            </button>
                        </div>

                    </form>
                </div>


                <aside class="col-lg-4">
                    <div class="row">

                    <!-- order preview -->
                        <div class="col-12">
                            <div class="card card-data bg-light">
                                <div class="card-header py-2 px-3">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <h3 class="fs-18 mb-0">{% trans 'Your Cart' %}</h3>
                                        </div>
                                        <div class="col text-right">
                                            <a href="{% url 'cart:cart_detail' %}" class="underline eyebrow">
                                                Edit
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <ul class="list-group list-group-line">
                                        {% for item in cart %}
                                        <li class="list-group-item d-flex justify-content-between text-dark align-items-center">
                                            {{ item.product.name }} x{{ item.quantity }}
                                            <span>${{ item.total_price|floatformat:2 }}</span>
                                        </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <!-- order summary -->
                        <div class="col-12 mt-1">
                            <div class="card card-data bg-light">
                                <div class="card-header py-2 px-3">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <h3 class="fs-18 mb-0">{% trans 'Order Summary' %}</h3>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <ul class="list-group list-group-minimal">
                                        <li class="list-group-item d-flex justify-content-between align-items-center">
                                            {% trans 'Subtotal' %}
                                            <span>${{ cart.get_total_price|floatformat:2 }}</span>
                                        </li>
                                        {% if cart.coupon %}
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                {% blocktrans with code=cart.coupon.code discount=cart.coupon.discount %}
                                                    "{{ code }}"
                                                    <span>{{ discount }}% off</span>
                                                {% endblocktrans %}
                                            </li>
                                            <li class="list-group-item d-flex justify-content-between align-items-center">
                                                {% trans 'Discount' %}
                                                <span>- ${{ cart.get_discount|floatformat:2 }}</span>
                                            </li>
                                        {% endif %}
                                    </ul>
                                </div>
                                <div class="card-footer py-2">
                                    <ul class="list-group list-group-minimal">
                                        <li class="list-group-item d-flex justify-content-between align-items-center text-dark fs-18">
                                            {% trans 'Total' %}
                                            <span>${{ cart.get_total_price_after_discount|floatformat:2 }}</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                    </div>
                </aside>

            </div>
        </div>
    </section>
{% endblock %}